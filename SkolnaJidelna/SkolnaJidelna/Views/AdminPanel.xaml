<Window x:Class="SkolniJidelna.AdminPanel"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:SkolniJidelna.ViewModels"
        mc:Ignorable="d"
        Title="AdminPanel" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <DataTemplate x:Key="StringEditor">
            <StackPanel>
                <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="BoolEditor">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="{Binding Name}" Margin="0,0,8,0" VerticalAlignment="Center"/>
                <CheckBox IsChecked="{Binding Value, Mode=TwoWay}" VerticalAlignment="Center"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="NumberEditor">
            <StackPanel>
                <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="DateEditor">
            <StackPanel>
                <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                <DatePicker SelectedDate="{Binding Value, Mode=TwoWay}" />
            </StackPanel>
        </DataTemplate>

        <vm:PropertyEditorSelector x:Key="EditorSelector"
                                   StringTemplate="{StaticResource StringEditor}"
                                   BoolTemplate="{StaticResource BoolEditor}"
                                   NumberTemplate="{StaticResource NumberEditor}"
                                   DateTemplate="{StaticResource DateEditor}"/>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*"/>
            <ColumnDefinition Width="1.5*"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Margin="20">
            <TextBlock Text="Vyber tabulku" FontWeight="Bold" Margin="0,0,0,6"/>
            <ComboBox ItemsSource="{Binding EntityTypes}" SelectedItem="{Binding SelectedEntityType}" DisplayMemberPath="Name" />
            <TextBlock Text="Položky" FontWeight="Bold" Margin="0,10,0,6"/>
            <ListBox ItemsSource="{Binding Items}" SelectedItem="{Binding SelectedItem}" DisplayMemberPath="Summary" Height="400"/>
            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                <Button Content="Obnovit" Command="{Binding RefreshCommand}" Margin="0,0,8,0"/>
                <Button Content="Zavřít" Command="{Binding CloseCommand}"/>
            </StackPanel>
        </StackPanel>

        <ScrollViewer Grid.Column="1" Margin="20">
            <StackPanel>
                <TextBlock Text="Detail" FontSize="20" FontWeight="Bold" Margin="0,0,0,8"/>
                <ItemsControl ItemsSource="{Binding Properties}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <ContentControl Content="{Binding}" ContentTemplateSelector="{StaticResource EditorSelector}" Margin="0,0,0,8"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                    <Button Content="Uložit" Command="{Binding SaveCommand}" Width="90" Margin="0,0,8,0"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>